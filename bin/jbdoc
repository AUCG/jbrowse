#!/usr/bin/env perl
use strict;
use warnings;

use Cwd;
use File::Spec;
use File::Basename;

# get jsdoc if needed
unless( -e File::Spec->catfile(qw( jslib/jsdoc/jsdoc )) ) {
    system 'git submodule update --init jslib/jsdoc';
}

# make sure our jsdocs are up to date
system 'make -f Makefile.deploy docs >/dev/null 2>&1';

exec $ENV{BROWSER} || 'firefox', html_file_for( $ARGV[0] );

###
sub html_file_for {
    my ( $n ) = @_;
    my $f = basename( $n, qr/\.[^.]*/);
    return File::Spec->catfile( 'docs', 'jsdoc', "$f.html" );
}
